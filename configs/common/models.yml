# configs/common/models.yml

families:
  spacy:
    spacy_cnn_quick:
      desc: spaCy TextCat CNN/Ensemble
      arch: cnn
      config_template: configs/spacy/textcat_cnn_base.cfg
      epochs: 5
      dropout: 0.1

    spacy_cnn_full:
      desc: TextCat spaCy CNN complet (profil full)
      arch: cnn
      lang: fr
      epochs: 15
      dropout: 0.2
      eval_frequency: 1000
      batch_start: 32
      batch_stop: 128
      config_template: configs/spacy/textcat_cnn_base.cfg

    spacy_bow_quick:
      desc: spaCy TextCat BOW (rapide)
      arch: bow
      lang: fr
      epochs: 5
      dropout: 0.2
      eval_frequency: 500
      batch_start: 16
      batch_stop: 64
      config_template: configs/spacy/textcat_bow_base.cfg

    spacy_cnn_debug:
      desc: spaCy TextCat CNN (debug, très léger)
      arch: cnn
      lang: fr
      epochs: 2
      dropout: 0.2
      eval_frequency: 200
      batch_start: 8
      batch_stop: 32
      config_template: configs/spacy/textcat_cnn_base.cfg

  sklearn:
    tfidf_svm_quick:
      desc: "TFIDF + LinearSVC, avec class weights issus du balance_strategy"
      vectorizer:
        class: sklearn.feature_extraction.text.TfidfVectorizer
        params:
          ngram_range: [1, 2]
          max_features: 50000
          min_df: 5
      estimator:
        class: sklearn.svm.LinearSVC
        params:
          C: 1.0
          class_weight: from_balance

    tfidf_smo_linear:
      desc: "TFIDF + LinearSVC (SMO linéaire, baseline sérieuse)"
      vectorizer:
        class: sklearn.feature_extraction.text.TfidfVectorizer
        params:
          ngram_range: [1, 2]
          max_features: 50000
          min_df: 5
      estimator:
        class: sklearn.svm.LinearSVC
        params:
          C: 0.5
          class_weight: balanced

    tfidf_smo_rbf:
      desc: "TFIDF + SVC (SMO RBF, plus lourd mais flexible)"
      vectorizer:
        class: sklearn.feature_extraction.text.TfidfVectorizer
        params:
          ngram_range: [1, 2]
          max_features: 50000
          min_df: 5
      estimator:
        class: sklearn.svm.SVC
        params:
          C: 1.0
          kernel: rbf
          gamma: scale
          class_weight: from_balance

    tfidf_perceptron:
      desc: "TFIDF + Perceptron (classifieur linéaire en ligne)"
      vectorizer:
        class: sklearn.feature_extraction.text.TfidfVectorizer
        params:
          ngram_range: [1, 2]
          max_features: 50000
          min_df: 5
      estimator:
        class: sklearn.linear_model.Perceptron
        params:
          max_iter: 50
          tol: 0.001
          class_weight: balanced
          n_jobs: -1

    tfidf_randomtree:
      desc: "TFIDF + DecisionTree (arbre plus costaud)"
      vectorizer:
        class: sklearn.feature_extraction.text.TfidfVectorizer
        params:
          ngram_range: [1, 2]
          max_features: 50000
          min_df: 5
      estimator:
        class: sklearn.tree.DecisionTreeClassifier
        params:
          max_depth: 30
          min_samples_split: 10
          min_samples_leaf: 4
          class_weight: balanced
          random_state: 42

    tfidf_randomforest:
      desc: "TFIDF + RandomForest (forêt aléatoire)"
      vectorizer:
        class: sklearn.feature_extraction.text.TfidfVectorizer
        params:
          ngram_range: [1, 2]
          max_features: 50000
          min_df: 5
      estimator:
        class: sklearn.ensemble.RandomForestClassifier
        params:
          n_estimators: 200
          max_depth: 25
          min_samples_leaf: 3
          class_weight: balanced
          n_jobs: -1
          random_state: 42

    tfidf_decisiontree_quick:
      desc: "TFIDF + DecisionTree (quick/debug)"
      vectorizer:
        class: sklearn.feature_extraction.text.TfidfVectorizer
        params:
          ngram_range: [1, 2]
          max_features: 50000
          min_df: 5
      estimator:
        class: sklearn.tree.DecisionTreeClassifier
        params:
          max_depth: 40
          min_samples_split: 5
          min_samples_leaf: 2
          class_weight: balanced
          random_state: 42

    tfidf_smo_quick:
      desc: "TFIDF + LinearSVC (SMO rapide)"
      vectorizer:
        class: sklearn.feature_extraction.text.TfidfVectorizer
        params:
          ngram_range: [1, 2]
          max_features: 50000
          min_df: 5
      estimator:
        class: sklearn.svm.LinearSVC
        params:
          C: 0.8
          class_weight: balanced

  hf:
    camembert_base:
      desc: "CamemBERT base"
      model_name: camembert-base
      tokenizer_class: transformers.AutoTokenizer
      model_class: transformers.AutoModelForSequenceClassification
      use_class_weights: false
      trainer_params: null
      learning_rate: 2e-5
      per_device_train_batch_size: 8
      per_device_eval_batch_size: 8
      num_train_epochs: 3
      weight_decay: 0.01
      warmup_ratio: 0.0
      gradient_accumulation_steps: 1

    flaubert_base_cased:
      desc: "FlauBERT-base-cased classification (FR, CPU)"
      model_name: flaubert/flaubert_base_cased
      tokenizer_class: transformers.AutoTokenizer
      model_class: transformers.AutoModelForSequenceClassification
      use_class_weights: true
      trainer_params: null
      learning_rate: 2e-5
      per_device_train_batch_size: 8
      per_device_eval_batch_size: 8
      num_train_epochs: 3
      weight_decay: 0.01
      warmup_ratio: 0.1
      gradient_accumulation_steps: 1

    bert_mbert_quick:
      desc: "BERT multilingue (quick)"
      model_name: bert-base-multilingual-cased
      tokenizer_class: transformers.AutoTokenizer
      model_class: transformers.AutoModelForSequenceClassification
      use_class_weights: true
      trainer_params: null
      learning_rate: 3e-5
      per_device_train_batch_size: 8
      per_device_eval_batch_size: 8
      num_train_epochs: 2
      weight_decay: 0.0
      warmup_ratio: 0.0
      gradient_accumulation_steps: 1
